{% extends "base.html" %}
{% load static %}

{% block title %} Entrada/Saída {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
        <div class="py-4">
            <div class="d-flex align-items-center">
                <div class="justify-content-between">
                    {% include 'client/cria_cliente.html' %}
                    <button type="button" class="btn btn-gray-800 d-inline-flex align-items-center me-2" data-bs-toggle="modal" data-bs-target="#criacliente">
                        <svg class="icon icon-xs me-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        Adicionar Cliente
                    </button>
                </div>
                <div class="justify-content-between w-50">
                    <div class="input-group input-group-merge search-bar">
                        <span class="input-group-text">
                            <svg class="icon icon-xs" x-description="Heroicon name: solid/search" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
                            </svg>
                        </span>
                        <input type="text" id="search" name="search" class="form-control" placeholder="Buscar clientes" aria-controls="clientes" aria-label="Default" aria-describedby="inputGroup-sizing-default">
                    </div>
                </div>
            </div>
        </div>
        <div class="card border-0 shadow mb-4">
            <div class="card-header d-sm-flex flex-row align-items-center flex-0">
                <div class="d-block mb-3 mb-sm-0">
                    <div class="fs-5 fw-normal mb-2">Clientes</div>
                </div>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-centered table-nowrap mb-0 rounded" id="clientes" style="width:100%;">
                        <thead class="thead-light">
                            <th class="border-0 rounded-start" hidden>ID</th>
                            <th class="border-0">Categoria</th>
                            <th class="border-0">Pessoa</th>
                            <th class="border-0">Nome</th>
                            <th class="border-0">CPF/CNPJ</th>
                            <th class="border-0">Contato</th>
                            <th class="border-0">E-mail</th>
                            <th class="border-0">Anexos</th>
                            <th class="border-0 rounded-end">Ações</th>
                        </thead>
                        <tbody>
                            {% if clientes %}
                                {% for cliente in clientes %}
                                <tr>
                                    <td class="border-0" hidden>{{ cliente.id }}</td>
                                    <td class="border-0">
                                        <div class="row">
                                            <div class="col-3">
                                                {% if cliente.categoria.categoria == 'Prestador de Serviço' %}
                                                <button type="button" class="btn btn-info" title="Prestador de Serviço" data-toggle="tooltip">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-tools" viewBox="0 0 16 16">
                                                        <path d="M1 0 0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.27 3.27a.997.997 0 0 0 1.414 0l1.586-1.586a.997.997 0 0 0 0-1.414l-3.27-3.27a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0Zm9.646 10.646a.5.5 0 0 1 .708 0l2.914 2.915a.5.5 0 0 1-.707.707l-2.915-2.914a.5.5 0 0 1 0-.708ZM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11Z"/>
                                                    </svg>
                                                </button>
                                                {% elif cliente.categoria.categoria == 'Fornecedor' %}
                                                <button type="button" class="btn btn-warning" title="Fornecedor" data-toggle="tooltip">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-seam-fill" viewBox="0 0 16 16">
                                                        <path fill-rule="evenodd" d="M15.528 2.973a.75.75 0 0 1 .472.696v8.662a.75.75 0 0 1-.472.696l-7.25 2.9a.75.75 0 0 1-.557 0l-7.25-2.9A.75.75 0 0 1 0 12.331V3.669a.75.75 0 0 1 .471-.696L7.443.184l.01-.003.268-.108a.75.75 0 0 1 .558 0l.269.108.01.003 6.97 2.789ZM10.404 2 4.25 4.461 1.846 3.5 1 3.839v.4l6.5 2.6v7.922l.5.2.5-.2V6.84l6.5-2.6v-.4l-.846-.339L8 5.961 5.596 5l6.154-2.461L10.404 2Z"/>
                                                    </svg>
                                                </button>
                                                {% elif cliente.categoria.categoria == 'Cliente' %}
                                                    {% if cliente.aluguel == True %}
                                                    <button type="button" class="btn btn-info" title="Aluguel" data-toggle="tooltip">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-key-fill" viewBox="0 0 16 16">
                                                            <path d="M3.5 11.5a3.5 3.5 0 1 1 3.163-5H14L15.5 8 14 9.5l-1-1-1 1-1-1-1 1-1-1-1 1H6.663a3.5 3.5 0 0 1-3.163 2zM2.5 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                                                        </svg>
                                                    </button>
                                                    {% endif %}
                                                    {% if cliente.compra == True %}
                                                    <button type="button" class="btn btn-success" title="Compra" data-toggle="tooltip">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cash-coin" viewBox="0 0 16 16">
                                                            <path fill-rule="evenodd" d="M11 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm5-4a5 5 0 1 1-10 0 5 5 0 0 1 10 0z"/>
                                                            <path d="M9.438 11.944c.047.596.518 1.06 1.363 1.116v.44h.375v-.443c.875-.061 1.386-.529 1.386-1.207 0-.618-.39-.936-1.09-1.1l-.296-.07v-1.2c.376.043.614.248.671.532h.658c-.047-.575-.54-1.024-1.329-1.073V8.5h-.375v.45c-.747.073-1.255.522-1.255 1.158 0 .562.378.92 1.007 1.066l.248.061v1.272c-.384-.058-.639-.27-.696-.563h-.668zm1.36-1.354c-.369-.085-.569-.26-.569-.522 0-.294.216-.514.572-.578v1.1h-.003zm.432.746c.449.104.655.272.655.569 0 .339-.257.571-.709.614v-1.195l.054.012z"/>
                                                            <path d="M1 0a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h4.083c.058-.344.145-.678.258-1H3a2 2 0 0 0-2-2V3a2 2 0 0 0 2-2h10a2 2 0 0 0 2 2v3.528c.38.34.717.728 1 1.154V1a1 1 0 0 0-1-1H1z"/>
                                                            <path d="M9.998 5.083 10 5a2 2 0 1 0-3.132 1.65 5.982 5.982 0 0 1 3.13-1.567z"/>
                                                        </svg>
                                                    </button>
                                                    {% endif %}
                                                    {% if cliente.venda == True %}
                                                    <button type="button" class="btn btn-secondary" title="Venda" data-toggle="tooltip">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bag-fill" viewBox="0 0 16 16">
                                                            <path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1zm3.5 3v-.5a3.5 3.5 0 1 0-7 0V4H1v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V4h-3.5z"/>
                                                        </svg>
                                                    </button>
                                                    {% endif %}
                                                {% endif %}
                                            </div>
                                        </div>
                                    </td>
                                    <td class="border-0">
                                        <div class="d-flex align-items-center">
                                            <span class="h6">{{ cliente.tipo_pessoa }}</span>
                                        </div>
                                    </td>
                                    <td class="border-0">
                                        <div class="d-flex align-items-center">
                                            <span class="h6">{{ cliente.nomecliente }}</span>
                                        </div>
                                    </td>
                                    <td class="border-0">
                                        <div class="d-flex align-items-center">
                                            <span class="h6">{{ cliente.cpf_cnjp }}</span>
                                        </div>
                                    </td>
                                    <td class="border-0">
                                        <div class="d-flex align-items-center">
                                            <span class="h6">{{ cliente.telefone }}</span>
                                        </div>
                                    </td>
                                    <td class="border-0">
                                        <div class="d-flex align-items-center">
                                            <span class="h6">{{ cliente.email }}</span>
                                        </div>
                                    </td>
                                    <td class="border-0">
                                        {% if cliente.anexo %}
                                        <div class="d-flex align-items-center">
                                            <a class="btn btn-secondary" href="{{ cliente.anexo.url }}" type="button" title="Anexo" data-toggle="tooltip" download>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-paperclip" viewBox="0 0 16 16">
                                                    <path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5 1.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0V3z"/>
                                                </svg>
                                            </a>
                                        </div> 
                                        {% endif %}
                                    </td>
                                    <td class="border-0">
                                        <div class="d-flex align-items-center">
                                            <div class="row">
                                                <div class="col-3">
                                                    {% include 'client/edita_cliente.html' %}
                                                    <button type="button" class="btn btn-info" data-bs-toggle="modal" data-bs-target="#editacliente{{ cliente.id }}" title="Editar" data-toggle="tooltip">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pen-fill" viewBox="0 0 16 16">
                                                            <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001z"/>
                                                        </svg>
                                                    </button>
                                                    {% include 'client/consulta_cliente.html' %}
                                                    <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#consultacliente{{ cliente.id }}" title="Consultar" data-toggle="tooltip">
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard2-fill" viewBox="0 0 16 16">
                                                            <path d="M9.5 0a.5.5 0 0 1 .5.5.5.5 0 0 0 .5.5.5.5 0 0 1 .5.5V2a.5.5 0 0 1-.5.5h-5A.5.5 0 0 1 5 2v-.5a.5.5 0 0 1 .5-.5.5.5 0 0 0 .5-.5.5.5 0 0 1 .5-.5h3Z"/>
                                                            <path d="M3.5 1h.585A1.498 1.498 0 0 0 4 1.5V2a1.5 1.5 0 0 0 1.5 1.5h5A1.5 1.5 0 0 0 12 2v-.5c0-.175-.03-.344-.085-.5h.585A1.5 1.5 0 0 1 14 2.5v12a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-12A1.5 1.5 0 0 1 3.5 1Z"/>
                                                        </svg>
                                                    </button>
                                                    <a class="btn btn-danger" href="{% url 'deletacliente' cliente.id %}" type="button" title="Apagar" data-toggle="tooltip"> 
                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3-fill" viewBox="0 0 16 16">
                                                            <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
                                                        </svg>
                                                    </a>
                                                </div>
                                            </div>
                                        </div> 
                                    </td>
                                </tr>
                                {% endfor %}
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        {% for message in messages %}
            {% if message.tags == 'success' %}
                <!-- Mensagens -->
                <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
                <script>
                    var m = "{{ message }}";
                    swal("Perfeito!", m, "success")
                </script>
            {% endif %}
        {% endfor %}

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
        <script type="text/javascript" src="{% static 'assets/js/cliente/clientes.js' %}"></script>
        <script type="text/javascript" src="{% static 'assets/js/cliente/criacliente.js' %}"></script>
        <script>
            $('.dropify').dropify({
                // default file for the file input
                defaultFile: '',

                // max file size allowed
                maxFileSize: 0,

                // custom messages
                messages: {
                    'default': 'Arraste e solte um arquivo aqui ou clique',
                    'replace': 'Arraste e solte ou clique para substituir',
                    'remove':  'Apagar',
                    'error':   'Desculpe, este arquivo é muito grande'
                },
            });
        </script>
{% endblock javascripts %}